<div class="style-title">
  <h2><%= @item.name %></h2>
  <div class="infos-item">

    <div class="info-pill">
      <i class="fas fa-layer-group"></i>
      <span><%= @item.category.name %></span>
    </div>

    <div class="info-pill">
      <i class="fas fa-star-half-alt"></i>
      <span><%= @item.state %></span>
    </div>

    <div class="info-pill">
      <i class="fas fa-cube"></i>
      <span>x<%= @item.possession %></span>
    </div>
  </div>
</div>

<div class="item-actions">
  <%= link_to "← Retour", collection_category_items_path(@collection, @category), class: "btn-action" %>
  <%= link_to "✏️ Modifier", edit_collection_category_item_path(@collection, @category, @item), class: "btn-action" %>
  <%= link_to "🗑️ Supprimer", collection_category_item_path(@collection, @category, @item),
      data: { turbo_method: :delete, turbo_confirm: "Supprimer cet item ?" }, class: "btn-action delete" %>
</div>

<div data-controller="photo-modal">
  <% photos = @item.photos.to_a %>

  <% if photos[0] %>
    <div class="photo-hero">
      <%= image_tag url_for(photos.first),
            class: "photo-hero-img",
            resource_type: :image,
            alt: @item.name,
            data: {
              action: "click->photo-modal#show",
              photo_modal_url_value: cl_image_path(photos[0].key)
            } %>
    </div>
  <% end %>

  <% if photos.size > 1 %>
    <div class="photo-gallery">
      <% photos[1..].each do |photo| %>
        <%= image_tag url_for(photo),
              class: "photo-gallery-thumb",
              resource_type: :image,
              alt: @item.name,
              data: {
                action: "click->photo-modal#show",
                photo_modal_url_value: cl_image_path(photo.key)
              } %>
      <% end %>
    </div>
  <% end %>

  <div data-photo-modal-target="overlay" class="modal hidden">
    <div class="modal-content">
      <img data-photo-modal-target="image" src="" alt="Photo agrandie">
      <button data-action="click->photo-modal#hide" class="modal-close">Fermer</button>
    </div>
  </div>
</div>

<% if @item.metadata.present? %>
  <p><strong><i class="fa-solid fa-coins"></i></strong> <%= @item.price %>€</p>
  <p><strong><i class="fa-solid fa-book-open"></i></strong> <%= @item.metadata["description"] %></p>
  <p><strong><i class="fa-solid fa-users"></i></strong> <%= @item.metadata["authors"] %></p>
  <p><strong><i class="fa-solid fa-square-pen"></i></strong> <%= @item.metadata["publisher"] %></p>
  <p><strong><i class="fa-solid fa-language"></i></strong> <%= @item.metadata["language"] %></p>
  <p><strong><i class="fa-solid fa-calendar"></i></strong> <%= @item.metadata["published_date"] %></p>
<% end %>

<div class="infos-tags">
  <% @tags.each do |tag| %>
    <div class="info-pill">
      <i class="fas fa-tag"></i>
      <span><%= tag.name %></span>
    </div>
    <div class="info-pill">
      <i class="fas fa-calendar-alt"></i>
      <span><%= tag.year %></span>
    </div>
    <div class="info-pill comment">
      <i class="fas fa-comment-dots"></i>
      <span><%= tag.comments %></span>
    </div>
  <% end %>
</div>
