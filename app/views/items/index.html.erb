<div class="home-banner">
  <div class="cyber-container">

    <!-- Terminal Header -->
    <div class="terminal-header">
      <div class="terminal-dots">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot green"></span>
      </div>
      <div class="terminal-title">items.exe</div>
    </div>

    <!-- Collection & Category Title -->
    <h1 class="cyber-page-title glitch-text" data-text="<%= @collection.name %> - <%= @category.name %>"><%= @collection.name %> - <%= @category.name %></h1>
    <p class="cyber-subtitle typing-effect">Gestion des éléments de la collection</p>

    <!-- Actions cyberpunk -->
    <div class="cyber-actions">
      <%= link_to collection_categories_path, class: "cyber-btn secondary" do %>
        <i class="fas fa-arrow-left"></i>
        Retour
      <% end %>
      <%= link_to collection_path(@collection), method: :delete, data: { turbo_confirm: "Supprimer cette collection ?" }, class: "cyber-btn danger" do %>
        <i class="fas fa-trash"></i>
        Supprimer Collection
      <% end %>
    </div>

    <!-- Items Grid or Add Form -->
    <% if @category.items.empty? %>
      <div class="cyber-add-section">
        <% case @category.name %>
        <% when "Livre" %>
          <%= render "add_book", collection: @collection, category: @category, item: @item %>
        <% when "Jeux Vidéo" %>
          <%= render "add_videogame", collection: @collection, category: @category, item: @item %>
        <% when "Film" %>
          <%= render "add_movie", collection: @collection, category: @category, item: @item %>
        <% when "Figurine" %>
          <%= render "add_toy", collection: @collection, category: @category, item: @item %>
        <% when "Autres" %>
          <%= render "add_item", collection: @collection, category: @category, item: @item %>
        <% end %>
      </div>
    <% else %>
      <div class="cyber-grid">
        <% @category.items.each do |item| %>
          <% css_classes = ["grid-item", "item-cyber"]
             css_classes << "item-owned" if item.owned?
             css_classes << "item-wanted" if item.wanted? %>
          <!-- DEBUG: Item <%= item.name %> - Status: <%= item.status %> - Classes: <%= css_classes.join(" ") %> -->
          <%= link_to collection_category_item_path(@collection, @category, item), class: css_classes.join(" ") do %>
            <div class="scan-line"></div>
            <div class="item-image" style="background-image: url('<%= item.photos.attached? ? cl_image_path(item.photos.first.key) : asset_path('default_collection.jpg') %>')"></div>
            <div class="item-content">
              <div class="item-header">
                <i class="fas fa-cube"></i>
                <span class="card-title"><%= item.name %></span>
              </div>
              <div class="item-stats">
                <span class="cyber-tag">
                  <i class="fas fa-tags"></i>
                  <%= item.class.name.humanize %>
                </span>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% end %>

  </div>
</div>
