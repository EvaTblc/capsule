<div class="home-banner" data-controller="image-preview">
  <div class="cyber-container">

    <!-- Terminal Header -->
    <div class="terminal-header">
      <div class="terminal-dots">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot green"></span>
      </div>
      <div class="terminal-title">user_register.exe</div>
    </div>

    <!-- Titre -->
    <h1 class="cyber-page-title glitch-text" data-text="INSCRIPTION">INSCRIPTION</h1>
    <p class="cyber-subtitle typing-effect">Création d'un nouveau profil utilisateur</p>

    <!-- Formulaire cyberpunk -->
    <div class="cyber-form">
      <%= form_with model: resource,
                    scope: resource_name,
                    url: registration_path(resource_name),
                    local: true,
                    authenticity_token: true,
                    class: "cyber-form-inner" do |f| %>

        <!-- Messages d'erreur cyberpunk -->
        <% if resource.errors.any? %>
          <div class="cyber-card" style="border-color: var(--cyber-red); margin-bottom: 2rem;">
            <div class="card-title" style="color: var(--cyber-red);">
              System Error: <%= pluralize(resource.errors.count, "erreur") %>
            </div>
            <ul style="color: var(--cyber-red); font-family: 'Courier New', monospace;">
              <% resource.errors.full_messages.each do |message| %>
                <li>// <%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="form-group">
          <%= f.label :username, "Username" %>
          <%= f.text_field :username,
                required: true,
                autofocus: true,
                autocomplete: "username",
                placeholder: "hackerman_2024" %>
        </div>

        <div class="form-group">
          <%= f.label :email, "Email Address" %>
          <%= f.email_field :email,
                required: true,
                autocomplete: "email",
                placeholder: "user@capsule.com" %>
        </div>

        <div class="form-group">
          <%= f.label :password, "Security Key" %>
          <%= f.password_field :password,
                required: true,
                autocomplete: "new-password",
                placeholder: "••••••••••" %>
          <% if @minimum_password_length %>
            <small style="color: var(--cyber-gray); font-family: 'Courier New', monospace;">
              // Minimum <%= @minimum_password_length %> caractères requis
            </small>
          <% end %>
        </div>

        <div class="form-group">
          <%= f.label :password_confirmation, "Confirm Security Key" %>
          <%= f.password_field :password_confirmation,
                required: true,
                autocomplete: "new-password",
                placeholder: "••••••••••" %>
        </div>

        <div class="form-group">
          <label style="color: var(--cyber-green); font-family: 'Orbitron', monospace;">
            // Avatar Selection
          </label>
          <div class="cyber-card" style="padding: 1rem; margin-top: 0.5rem;">
            <label class="cyber-btn secondary" for="user_avatar" style="cursor: pointer; width: 100%; text-align: center;">
              <i class="fas fa-upload"></i>
              Upload Avatar
            </label>
            <%= f.file_field :avatar,
                  id: "user_avatar",
                  required: true,
                  style: "display: none;",
                  data: {image_preview_target: "master", action:"change->image-preview#addFiles"} %>
            <div class="preview-grid new-grid" data-image-preview-target="list" style="margin-top: 1rem;"></div>
          </div>
        </div>

        <div class="form-actions" style="text-align: center; margin-top: 2rem;">
          <%= f.submit "CRÉER COMPTE", class: "cyber-btn primary" %>
        </div>

      <% end %>

      <!-- Navigation Links -->
      <div style="text-align: center; margin-top: 2rem;">
        <%= render "devise/shared/links" %>
      </div>
    </div>
  </div>
</div>
