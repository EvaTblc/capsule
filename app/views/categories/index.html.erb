<div class="home-banner">
  <div class="cyber-container" data-controller="toggle">

    <!-- Terminal Header -->
    <div class="terminal-header">
      <div class="terminal-dots">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot green"></span>
      </div>
      <div class="terminal-title">categories.exe</div>
    </div>

    <!-- Collection Title -->
    <h1 class="cyber-page-title glitch-text" data-toggle-target="mainTitle" data-text="<%= @collection.name %>"><%= @collection.name %></h1>
    <div data-toggle-target="formTitle" class="d-none">
      <%= form_with model: @collection, class: "form-capsule" do |f| %>
        <%= f.text_field :name,
                    label: false,
                    class: "input-form" %>
        <div class="actions-save">
          <%= link_to "← Retour", collection_categories_path(@collection), class: "btn-action" %>
          <%= f.submit "Sauvegarder", class: "btn-action" %>
        </div>
      <% end %>
    </div>
    <p class="cyber-subtitle typing-effect">Gestion des catégories</p>

    <!-- Actions cyberpunk -->
    <div class="cyber-actions">
      <%= link_to collections_path, class: "cyber-btn secondary" do %>
        <i class="fas fa-arrow-left"></i>
        Retour
      <% end %>
      <button data-toggle-target="linkTitle" data-action="click->toggle#toggle" class="cyber-btn primary">
        <i class="fas fa-edit"></i>
        Modifier
      </button>
      <%= link_to collection_path(@collection), data: { turbo_method: :delete, turbo_confirm: "Supprimer cette collection ?" }, class: "cyber-btn danger" do %>
        <i class="fas fa-trash"></i>
        Supprimer
      <% end %>
    </div>

    <!-- Categories Grid -->
    <% if @collection.categories.empty? %>
      <div class="cyber-empty-state">
        <%= render "shared/empty_cat", collection: @collection, category: @category %>
      </div>
    <% else %>
      <div class="cyber-grid categories-grid">
        <% @categories.each do |category| %>
          <div class="grid-item category-cyber">
            <div class="scan-line"></div>

            <!-- Category Header -->
            <div class="category-header">
              <div class="category-content">
                <%= link_to collection_category_items_path(@collection, category), class: "category-link" do %>
                  <div class="category-icon">
                    <i class="fas fa-layer-group"></i>
                  </div>
                  <div class="category-info">
                    <span class="card-title card-title-main"><%= category.name %></span>
                    <div class="collection-stats">
                      <span class="cyber-tag">
                        <i class="fas fa-cube"></i>
                        <%= pluralize(category.items.count, 'item' )%>
                      </span>
                    </div>
                  </div>
                <% end %>
              </div>

              <div class="category-actions">
                <%= link_to collection_category_path(@collection, category), data: { turbo_method: :delete, turbo_confirm: "Supprimer cette catégorie ?" }, class: "cyber-edit-btn" do %>
                  <i class="fas fa-trash"></i>
                <% end %>

                <button type="button" class="cyber-edit-btn" data-toggle-target="buttonCategory" data-action="click->toggle#toggle">
                  <i class="fas fa-edit"></i>
                </button>
              </div>
            </div>

            <!-- Edit Form -->
            <div data-toggle-target="div" class="category-edit-form d-none">
              <%= form_with model: [@collection, category], class: "cyber-form-inline" do |f| %>
                <div class="form-group mb-2">
                  <%= f.text_field :name, class: "cyber-input" %>
                </div>
                <div class="form-actions">
                  <%= link_to "Annuler", "#", class: "cyber-btn secondary btn-sm", data: { action: "click->toggle#toggle" } %>
                  <%= f.submit "Sauvegarder", class: "cyber-btn success btn-sm" %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>

  </div>
</div>
